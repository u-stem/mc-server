# クロスプレイガイド

Java版と統合版（Bedrock Edition）プレイヤーが一緒に遊ぶための設定方法を説明します。

---

## 方法の選択

| 方法 | 説明 | 推奨ケース |
|------|------|-----------|
| GeyserMC（Java版サーバー + プラグイン） | Java版サーバーに統合版プレイヤーが参加 | Java版プレイヤーがメイン、統合版は少数 |
| Bedrock専用サーバー | 統合版プレイヤー専用 | 統合版プレイヤーのみ |

---

## GeyserMC を使用したクロスプレイ

Java版サーバー（Paper, Spigot等）に GeyserMC プラグインをインストールすると、統合版プレイヤーも参加できるようになります。

### 必要なもの

- プラグイン対応サーバー: Paper, Spigot, Purpur, Folia 等
- GeyserMC プラグイン
- Floodgate プラグイン（オプション: 統合版プレイヤーがJava版アカウント不要に）

### セットアップ手順

#### 1. プラグインのインストール

管理画面のサーバー詳細 → Mod / プラグインタブで以下をインストール:

1. GeyserMC をインストール（おすすめプラグインから1クリック）
2. Floodgate をインストール（オプション）

#### 2. サーバーを再起動

プラグインを有効にするためサーバーを再起動します。

#### 3. 統合版プレイヤーの接続

統合版プレイヤーは以下の情報で接続:

- サーバーアドレス: `<サーバーIP>`
- ポート: `19132`（デフォルト）

### Floodgate について

Floodgate を使用すると、統合版プレイヤーは Java版の Minecraft アカウントを持っていなくても参加できます。

- 統合版プレイヤーの名前には自動的にプレフィックス（デフォルト: `.`）が付きます
- 例: 統合版プレイヤー `Steve` は `.Steve` として表示されます
- ホワイトリストには `.Steve` の形式で追加してください

### GeyserMC の制限事項

- 一部のアイテムやブロックの挙動が異なる場合があります
- 統合版特有の機能（アドオン等）は使用できません
- 若干の遅延が発生する可能性があります

---

## Bedrock専用サーバー

統合版プレイヤーのみでプレイする場合は、Bedrock専用サーバーを作成できます。

### セットアップ手順

1. 管理画面で「新規作成」をクリック
2. エディションで「統合版（Bedrock）」を選択
3. サーバー名、バージョン、ポートを設定
4. 「作成」をクリック

### 対応デバイス

- スマートフォン（iOS / Android）
- Nintendo Switch
- Xbox
- PlayStation
- Windows 10/11（Bedrock版）

### 制限事項

- Java版プレイヤーは接続できません
- Mod / プラグインは使用できません（アドオンのみ）
- RCON によるリモート管理は利用できません

---

## 接続方法（統合版クライアント）

### スマートフォン / タブレット

1. Minecraft を起動し「遊ぶ」をタップ
2. 「サーバー」タブを選択
3. 「サーバーを追加」をタップ
4. サーバー情報を入力:
   - サーバー名: 任意の名前
   - サーバーアドレス: サーバーの IP アドレス
   - ポート: `19132`（またはサーバー設定のポート）
5. 「保存」してサーバーを選択

### Windows 10/11（Bedrock版）

1. Minecraft を起動し「遊ぶ」をクリック
2. 「サーバー」タブを選択
3. 「サーバーを追加」をクリック
4. サーバー情報を入力
5. 「保存」して接続

### Nintendo Switch / Xbox / PlayStation

コンソール版では外部サーバーへの直接接続が制限されています。
以下のいずれかの方法で接続できる場合があります:

- BedrockConnect
- Phantom
- DNS 設定の変更

詳細は各ツールのドキュメントを参照してください。

---

## トラブルシューティング

### 統合版から接続できない

1. サーバーが起動しているか確認
2. ポート番号が正しいか確認（デフォルト: 19132/UDP）
3. ファイアウォールで UDP ポートが開放されているか確認
4. Tailscale 使用時は UDP トラフィックが許可されているか確認

### Floodgate 使用時にログインできない

1. プレイヤー名にプレフィックス（`.`）を付けてホワイトリストに追加
2. Floodgate の設定ファイル（`plugins/floodgate/config.yml`）を確認
3. サーバーを再起動

### 動作が重い / ラグがある

- GeyserMC は変換処理を行うため、若干のオーバーヘッドがあります
- サーバーのメモリ割り当てを増やしてみてください
- プレイヤー数が多い場合は Bedrock専用サーバーを検討してください
